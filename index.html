<!DOCTYPE html>
<html xmlns="//www.w3.org/1999/html" xmlns="//www.w3.org/1999/html">
	
<head>
    <title>Wave Coffee</title>
	<link rel="shortcut icon" href="favicon.ico"/>
	<input type="hidden" id="email" name="email" value="marc.sassoon@genesys.com">
	<input type="hidden" id="firstname" name="firstname" value="Marc">
	<input type="hidden" id="lastname" name="lastname" value="Sassoon">
<meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Set URL parms -->
	
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-177251718-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-177251718-1');
  console.log('GA tag loaded');
	 
</script>
	
<!-- OKTA code -->
<script src="https://global.oktacdn.com/okta-signin-widget/6.4.3/js/okta-sign-in.min.js" type="text/javascript"></script>
<link href="https://global.oktacdn.com/okta-signin-widget/6.4.3/css/okta-sign-in.min.css" type="text/css" rel="stylesheet"/>
	
<script>
  const signIn = new OktaSignIn({baseUrl: 'https://dev-69124392.okta.com'});

  signIn.showSignInToGetTokens({
    scopes: ['openid', 'profile'] // optional
  }).then(function(tokens) {
    // Store tokens
  }).catch(function(error) {
    // This function is invoked with errors the widget cannot recover from:
    // Known errors: CONFIG_ERROR, UNSUPPORTED_BROWSER_ERROR
  });
</script>
	
<!-- Messenger code -->
	
    <script>
(function (g, e, n, es, ys) {
        g['_genesysJs'] = e;
        g[e] = g[e] || function () {
          (g[e].q = g[e].q || []).push(arguments)
        };
        g[e].t = 1 * new Date();
        g[e].c = es;
        ys = document.createElement('script'); ys.async = 1; ys.src = n; ys.charset = 'utf-8'; document.head.appendChild(ys);
      })(window, 'Genesys', 'https://apps.mypurecloud.ie/genesys-bootstrap/genesys.min.js', {
        environment: 'euw1',
        deploymentId: '820df811-6380-46a3-9320-929b3a8d39c2'
      });

	Genesys("subscribe", "Messenger.opened", function() {gtag('event','Engage',{'event_category':'GPEWM','event_label': 'Messenger opened'});});
   	Genesys("subscribe", "Conversations.started", function() {gtag('event','Engage',{'event_category':'GPEWM','event_label': 'Messenger Conversation started'});});
	Genesys("subscribe", "Messenger.closed", function() {gtag('event','Engage',{'event_category':'GPEWM','event_label': 'Messenger Closed'});});
	Genesys("subscribe", "Conversations.closed", function() {gtag('event','Engage',{'event_category':'GPEWM','event_label': 'Messenger Conversation closed'});});    
    </script>

	
<style>
.button {
top:450px;right:-15px;position:fixed;z-index:99999;padding:10px;color:#000000;border:1px solid #000000;transform: rotate(-90deg);height:43.5px;font-weight:700;
}

.chat-button {background-color: #ffffff!;}
</style>
	
</head>

<body>

<img src="images/home.jpg" alt="Home" usemap="#workmap" width=100% height=100%>
<map name="workmap">
  <area shape="rect" coords="288,74,638,123" alt="Store" href="store.html">
  <area shape="rect" coords="1055,465,1314,545" alt="Shop Now" href="store.html">
  <area shape="rect" coords="1033,77,1197,115" alt="Contact Us" href="contact.html">
</map>
	
<div class="container">
      <h1 class="text-center">Simple Web Page</h1>
      <div id="messageBox" class="jumbotron">
        You are not logged in.
      </div>
      <!-- where the sign-in form appears -->
      <div id="okta-login-container"></div>
      <button id="logout" class="button" onclick="logout()" style="display: none">Logout</button>
    </div>
    <script type="text/javascript">
       const oktaSignIn = new OktaSignIn({
          issuer: "https://dev-69124392.okta.com/oauth2/default",
          redirectUri: 'https://msassoon.github.io/WaveCoffee21 configured in your Okta OIDC app integration}',
          clientId: "0oa5ht86cxdWGt92Z5d7",
          useInteractionCodeFlow: true
       });

       // Search for URL Parameters to see if a user is being routed to the application to recover password
       var searchParams = new URL(window.location.href).searchParams;
       oktaSignIn.otp = searchParams.get('otp');
       oktaSignIn.state = searchParams.get('state');
	
	          oktaSignIn.authClient.token.getUserInfo().then(function(user) {
        document.getElementById("messageBox").innerHTML = "Hello, " + user.email + "! You are *still* logged in! :)";
        document.getElementById("logout").style.display = 'block';
      }, function(error) {
        oktaSignIn.showSignInToGetTokens({
          el: '#okta-login-container'
        }).then(function(tokens) {
          oktaSignIn.authClient.tokenManager.setTokens(tokens);
          oktaSignIn.remove();

          const idToken = tokens.idToken;
          document.getElementById("messageBox").innerHTML = "Hello, " + idToken.claims.email + "! You just logged in! :)";
          document.getElementById("logout").style.display = 'block';

        }).catch(function(err) {
          console.error(err);
        });
      });

      function logout() {
        oktaSignIn.authClient.signOut();
        location.reload();
      }
    </script>
	
</body>
</html>
